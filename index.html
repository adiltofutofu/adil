<?php
session_start();

if (isset($_POST['who'])) {
    if (isset($_POST['pass']) && $_POST['pass'] == 'php123') {
        $_SESSION['who'] = $_POST['who'];
        header('Location: game.php');
        return;
    } else {
        $error = "Incorrect password";
    }
}

if (isset($_SESSION['who'])) {
    $who = $_SESSION['who'];

    if (isset($_POST['human'])) {
        $human = $_POST['human'];
        $computer = rand(0, 2);
        $names = array("Rock", "Paper", "Scissors");
        $result = check($computer, $human, $names);
    }
} else {
    $who = '';
    $error = '';
}

function check($computer, $human, $names) {
    if ($computer == $human) {
        return "Tie";
    } elseif (($computer == 0 && $human == 1) || ($computer == 1 && $human == 2) || ($computer == 2 && $human == 0)) {
        return "You Win";
    } else {
        return "You Lose";
    }
}

?>

<!DOCTYPE html>
<html>
<head>
    <title>Rock Paper Scissors - 7884526f</title>
</head>
<body>
    <h1>Welcome to Rock Paper Scissors</h1>
    <?php
    if (isset($error)) {
        echo "<p>$error</p>";
    }
    if (isset($_SESSION['who'])) {
        echo "<form method='post'>
            <label for='who'>User Name</label>
            <input type='text' name='who' id='who' value='$who' size='40'><br>
            <select name='human'>
                <option value='0'>Rock</option>
                <option value='1'>Paper</option>
                <option value='2'>Scissors</option>
                <option value='3'>Test</option>
            </select>
            <input type='submit' value='Play'>
            <a href='?logout=1'>Logout</a>
        </form>";

        if (isset($result)) {
            echo "<p>Your Play=" . $names[$human] . " Computer Play=" . $names[$computer] . " Result=$result</p>";
        }
    } else {
        echo "<a href='login.php'>Please Log In</a>";
    }
    ?>
</body>
</html>
